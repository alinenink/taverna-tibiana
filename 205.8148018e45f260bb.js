"use strict";(self.webpackChunktaverna_tibiana=self.webpackChunktaverna_tibiana||[]).push([[205],{205:(E,m,i)=>{i.r(m),i.d(m,{LoginComponent:()=>f});var d=i(467),g=i(177),s=i(4341),c=i(5085),u=i(4796),e=i(4020),v=i(2210),h=i(7503);function _(o,b){if(1&o&&(e.j41(0,"div",21),e.EFF(1),e.k0s()),2&o){const n=e.XpG();e.R7$(),e.JRh(n.erro)}}function p(o,b){1&o&&(e.j41(0,"div",22)(1,"div",23),e.qSk(),e.j41(2,"svg",24)(3,"g",25),e.nrm(4,"path",26),e.k0s()()()())}let f=(()=>{class o{constructor(n,r,t,a){this.router=n,this.authService=r,this.analyticsService=t,this.scrollService=a,this.email="",this.password="",this.carregando=!1,this.erro=""}ngOnInit(){this.scrollService.scrollToTop(),(localStorage.getItem("authToken")||sessionStorage.getItem("authToken"))&&this.router.navigate(["/home"])}entrarComoVisitante(){this.analyticsService.trackLogin("guest"),this.carregando=!0,this.authService.authenticate({email:"visitante@gmail.com",password:"Visitante123*"}).then(r=>{r.subscribe({next:t=>{t.success&&t.token?(this.authService.setAuthData(t.token,t.user,t.user_id),this.analyticsService.trackFormSubmission("guest_login",!0),this.router.navigate(["/home"])):(this.erro=t.message||"Erro ao entrar como visitante. Tente novamente.",this.carregando=!1,this.analyticsService.trackFormSubmission("guest_login",!1))},error:t=>{this.carregando=!1,this.erro="Erro ao entrar como visitante. Tente novamente.",this.analyticsService.trackFormSubmission("guest_login",!1)}})})}login(){var n=this;return(0,d.A)(function*(){n.analyticsService.trackLogin("email"),n.carregando=!0,n.erro="";const r={email:n.email.trim(),password:n.password.trim()};try{(yield n.authService.authenticate(r)).subscribe({next:a=>{a.success&&a.token?(n.authService.setAuthData(a.token,a.user,a.user_id),n.carregando=!1,n.analyticsService.trackFormSubmission("login",!0),n.router.navigate(["/home"])):(n.erro=a.message||"Erro na autentica\xe7\xe3o. Verifique suas credenciais.",n.carregando=!1,n.analyticsService.trackFormSubmission("login",!1))},error:a=>{n.carregando=!1,console.error("Erro na autentica\xe7\xe3o:",a),n.analyticsService.trackFormSubmission("login",!1),n.erro=401===a.status?"\u{1f37a} Opa, nobre aventureiro! Tuas credenciais n\xe3o foram reconhecidas pelo taberneiro. Confere teu email m\xe1gico e tua palavra-passe, e tenta novamente!":"Erro ao conectar com o servidor. Tente novamente."}})}catch(t){n.carregando=!1,console.error("Erro ao processar autentica\xe7\xe3o:",t),n.analyticsService.trackFormSubmission("login",!1),n.erro="Erro interno. Tente novamente."}})()}static{this.\u0275fac=function(r){return new(r||o)(e.rXU(c.Ix),e.rXU(u.u),e.rXU(v.c),e.rXU(h.b))}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-login"]],decls:35,vars:5,consts:[[1,"parchment-background"],[1,"consulta-layout"],[1,"tavernatibiana-title"],[1,"parchment-card",2,"margin-bottom","1.2rem","text-align","center"],["src","assets/icons-svg/beer-mug.svg","alt","Beer",1,"svg-icon",2,"width","2em","height","2em","margin-bottom","0.2em","vertical-align","middle"],[2,"margin-left","5px","vertical-align","middle"],[2,"font-size","0.98em","color","#7a5a2f"],[1,"button-medieval",2,"margin-top","0.7em","width","80%","max-width","220px",3,"click"],[1,"parchment-card",3,"ngSubmit"],["class","login-error",4,"ngIf"],[1,"input-icon-group"],["src","assets/icons-svg/wizard.svg","alt","Email",1,"svg-icon"],["id","email","type","email","name","email","placeholder","Email m\xe1gico","required","",1,"input-medieval",3,"ngModelChange","ngModel"],["src","assets/icons-svg/key-skills.svg","alt","Senha",1,"svg-icon"],["id","password","type","password","name","password","placeholder","Palavra-passe da Irmandade","required","",1,"input-medieval",3,"ngModelChange","ngModel"],["type","submit",1,"button-medieval",3,"disabled"],[1,"login-links"],["routerLink","/register",1,"medieval-link"],[1,"medieval-link-sep"],["routerLink","/forgot-password",1,"medieval-link"],["class","svg-loader-overlay",4,"ngIf"],[1,"login-error"],[1,"svg-loader-overlay"],[1,"svg-loader"],["fill","#000000","height","80px","width","80px","viewBox","0 0 452.022 452.022"],["id","SVGRepo_iconCarrier"],["d","..."]],template:function(r,t){1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"h1",2),e.EFF(3,"Bem-vindo \xe0 Taverna Tibiana"),e.k0s(),e.j41(4,"div",3),e.nrm(5,"img",4),e.j41(6,"strong",5),e.EFF(7,"Quer dar s\xf3 uma espiada?"),e.k0s(),e.nrm(8,"br"),e.j41(9,"span",6),e.EFF(10,"Entre como visitante e explore a taverna sem compromisso!"),e.k0s(),e.nrm(11,"br"),e.j41(12,"button",7),e.bIt("click",function(){return t.entrarComoVisitante()}),e.EFF(13," Entrar como Visitante "),e.k0s()(),e.j41(14,"form",8),e.bIt("ngSubmit",function(){return t.login()}),e.j41(15,"h2"),e.EFF(16,"Juramento de Entrada"),e.k0s(),e.nrm(17,"hr"),e.DNE(18,_,2,1,"div",9),e.j41(19,"div",10),e.nrm(20,"img",11),e.j41(21,"input",12),e.mxI("ngModelChange",function(l){return e.DH7(t.email,l)||(t.email=l),l}),e.k0s()(),e.j41(22,"div",10),e.nrm(23,"img",13),e.j41(24,"input",14),e.mxI("ngModelChange",function(l){return e.DH7(t.password,l)||(t.password=l),l}),e.k0s()(),e.j41(25,"button",15),e.EFF(26," Adentrar a Taverna "),e.k0s(),e.j41(27,"div",16)(28,"a",17),e.EFF(29,"Alistar-se na Guilda"),e.k0s(),e.j41(30,"span",18),e.EFF(31,"|"),e.k0s(),e.j41(32,"a",19),e.EFF(33,"Esqueceste teu juramento?"),e.k0s()(),e.DNE(34,p,5,0,"div",20),e.k0s()()()),2&r&&(e.R7$(18),e.Y8G("ngIf",t.erro),e.R7$(3),e.R50("ngModel",t.email),e.R7$(3),e.R50("ngModel",t.password),e.R7$(),e.Y8G("disabled",t.carregando||!t.email||!t.password),e.R7$(9),e.Y8G("ngIf",t.carregando))},dependencies:[g.MD,g.bT,s.YN,s.qT,s.me,s.BC,s.cb,s.YS,s.vS,s.cV,c.iI,c.Wk],styles:[".consulta-layout[_ngcontent-%COMP%]{min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center}.parchment-card[_ngcontent-%COMP%]{max-width:350px;margin:0 auto;width:100%}.medieval-disclaimer[_ngcontent-%COMP%]{max-width:350px;margin:0 auto 1.2rem;width:100%;background:linear-gradient(#fdf8e4,#f4e6b3);border:2px solid #a67c52;border-radius:8px;padding:1.2rem 1.5rem;font-family:Georgia,serif;font-size:1.08rem;color:#3b2a1a;box-shadow:inset 0 0 8px #8b451326,2px 2px 6px #0000001a;text-align:center}@media (max-width: 480px){.parchment-card[_ngcontent-%COMP%], .medieval-disclaimer[_ngcontent-%COMP%]{max-width:98vw;padding:1rem .5rem;font-size:1rem}}input.input-medieval[_ngcontent-%COMP%]{flex:1;margin-bottom:1rem}.button-medieval[_ngcontent-%COMP%]{width:100%;margin-top:1rem}.login-error[_ngcontent-%COMP%]{color:#992e2e;font-weight:700;margin-bottom:1rem;text-align:center;font-family:MedievalSharp,serif}.input-icon-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin-bottom:1rem}.login-links[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;gap:1.5rem;margin-top:1.5rem;font-family:MedievalSharp,serif}.medieval-link[_ngcontent-%COMP%]{color:#7b5e3b;text-decoration:underline;cursor:pointer;font-weight:700;transition:color .2s}.medieval-link[_ngcontent-%COMP%]:hover{color:#a88d5a}.medieval-link-sep[_ngcontent-%COMP%]{color:#a67c52;font-weight:700;font-size:1.2em;margin:0 .2em;-webkit-user-select:none;user-select:none}"]})}}return o})()}}]);