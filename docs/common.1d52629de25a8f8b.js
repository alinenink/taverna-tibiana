"use strict";(self.webpackChunktaverna_tibiana=self.webpackChunktaverna_tibiana||[]).push([[76],{4231:(v,g,o)=>{o.d(g,{T:()=>y});var n=o(1626),E=o(8810),c=o(6354),l=o(9437),_=o(5875),h=o(4020);let y=(()=>{class a{constructor(t){this.http=t,this.baseUrl=_.c.apiUrl+"/weapons"}getCategories(){const t=(new n.Nl).set("action","categories");return this.http.get(`${this.baseUrl}?${t.toString()}`).pipe((0,c.T)(r=>{if(r.success&&r.data)return r.data;throw new Error(r.message||"Erro ao buscar categorias")}),(0,l.W)(this.handleError))}getAllWeapons(){const t=(new n.Nl).set("action","all");return this.http.get(`${this.baseUrl}?${t.toString()}`).pipe((0,c.T)(r=>{if(r.success&&r.data)return r.data;throw new Error(r.message||"Erro ao buscar todas as armas")}),(0,l.W)(this.handleError))}getWeaponsByCategory(t){const r=(new n.Nl).set("action","list").set("category",t);return this.http.get(`${this.baseUrl}?${r.toString()}`).pipe((0,c.T)(e=>{if(e.success)return e;throw new Error(e.message||"Erro ao buscar armas da categoria")}),(0,l.W)(this.handleError))}getWeaponDetails(t,r){if(!t||!r)return(0,E.$)(()=>new Error("Categoria e nome da arma s\xe3o obrigat\xf3rios"));const e=(new n.Nl).set("action","weapon").set("category",t).set("name",r),s=`${this.baseUrl}?${e.toString()}`;return this.http.get(s).pipe((0,c.T)(i=>{if(i.success)return i;throw new Error(i.message||"Erro ao buscar detalhes da arma")}),(0,l.W)(this.handleError))}searchWeapons(t,r){const e=(new n.Nl).set("action","list").set("category",t).set("search",r);return this.http.get(`${this.baseUrl}?${e.toString()}`).pipe((0,c.T)(s=>{if(s.success)return s;throw new Error(s.message||"Erro ao buscar armas")}),(0,l.W)(this.handleError))}getCategoryStats(t){return this.getWeaponsByCategory(t).pipe((0,c.T)(r=>{const e=r.data,s=e.length,i={},p={};let f=0,m=0;return e.forEach(d=>{i[d.vocation]=(i[d.vocation]||0)+1,p[d.tier]=(p[d.tier]||0)+1,f+=d.atk,m+=d.def}),{total:s,byVocation:i,byTier:p,avgAtk:s>0?f/s:0,avgDef:s>0?m/s:0}}))}hasElementalDamage(t){return t.proficiency?.levels?.some(r=>r.perks?.some(e=>e.description.toLowerCase().includes("fire")||e.description.toLowerCase().includes("ice")||e.description.toLowerCase().includes("energy")||e.description.toLowerCase().includes("earth")||e.description.toLowerCase().includes("death")||e.description.toLowerCase().includes("holy")))||!1}getPrimaryElementalType(t){if(!t.proficiency?.levels)return null;const r=["fire","ice","energy","earth","death","holy"];for(const e of t.proficiency.levels)for(const s of e.perks||[])for(const i of r)if(s.description.toLowerCase().includes(i))return i;return null}getCategoryDisplayName(t){return{swords:"Espadas",axes:"Machados",clavas:"Clavas",ranged:"Armas de Longo Alcance",rods:"Rods",wands:"Wands",fist:"Armas de Punho"}[t]||t}getIconAssetPath(t){return t.startsWith("assets/")||t.startsWith("http")?t:t.startsWith("icons/")?`assets/${t}`:"assets/icons/32_11345f84.png"}handleError(t){console.error("Erro na requisi\xe7\xe3o HTTP:",t);let r="Erro desconhecido";return r=t.error instanceof ErrorEvent?`Erro: ${t.error.message}`:t.error?.message||t.message||`C\xf3digo de erro: ${t.status}`,(0,E.$)(()=>new Error(r))}static{this.\u0275fac=function(r){return new(r||a)(h.KVO(n.Qq))}}static{this.\u0275prov=h.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})()},6706:(v,g,o)=>{o.d(g,{T:()=>_});var n=o(467),E=o(5875),c=o(4796),l=o(4020);let _=(()=>{class h{constructor(a){this.authService=a,this.baseURL=E.c.apiUrl}getHeaders(){return{"Content-Type":"application/json",Authorization:`Bearer ${this.authService.getToken()}`}}save(a){var u=this;return(0,n.A)(function*(){try{const t=yield fetch(`${u.baseURL}/weapons?action=save-perks`,{method:"POST",headers:u.getHeaders(),body:JSON.stringify(a)});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return yield t.json()}catch(t){throw console.error("Erro ao salvar profici\xeancia:",t),t}})()}get(a,u){var t=this;return(0,n.A)(function*(){try{const r=`${t.baseURL}/weapons?action=get-perks&weapon_name=${encodeURIComponent(a)}&weapon_category=${u}`,e=yield fetch(r,{headers:t.getHeaders()});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return yield e.json()}catch(r){throw console.error("Erro ao buscar profici\xeancia:",r),r}})()}list(a="",u=1,t=10){var r=this;return(0,n.A)(function*(){try{const e=`action=list-perks&page=${u}&limit=${t}${a?`&weapon_category=${a}`:""}`,s=yield fetch(`${r.baseURL}/weapons?${e}`,{headers:r.getHeaders()});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);return yield s.json()}catch(e){throw console.error("Erro ao listar profici\xeancias:",e),e}})()}static{this.\u0275fac=function(u){return new(u||h)(l.KVO(c.u))}}static{this.\u0275prov=l.jDH({token:h,factory:h.\u0275fac,providedIn:"root"})}}return h})()}}]);