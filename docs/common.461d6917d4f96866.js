"use strict";(self.webpackChunktaverna_tibiana=self.webpackChunktaverna_tibiana||[]).push([[76],{4231:(y,p,o)=>{o.d(p,{T:()=>_});var n=o(1626),u=o(8810),i=o(6354),l=o(9437),m=o(5875),g=o(4020);let _=(()=>{class h{constructor(t){this.http=t,this.baseUrl=m.c.apiUrl+"/weapons"}getCategories(){const t=(new n.Nl).set("action","categories");return this.http.get(`${this.baseUrl}?${t.toString()}`).pipe((0,i.T)(r=>{if(r.success&&r.data)return r.data;throw new Error(r.message||"Erro ao buscar categorias")}),(0,l.W)(this.handleError))}getAllWeapons(){const t=(new n.Nl).set("action","all");return this.http.get(`${this.baseUrl}?${t.toString()}`).pipe((0,i.T)(r=>{if(r.success&&r.data)return r.data;throw new Error(r.message||"Erro ao buscar todas as armas")}),(0,l.W)(this.handleError))}getWeaponsByCategory(t){const r=(new n.Nl).set("action","list").set("category",t);return this.http.get(`${this.baseUrl}?${r.toString()}`).pipe((0,i.T)(e=>{if(e.success)return e;throw new Error(e.message||"Erro ao buscar armas da categoria")}),(0,l.W)(this.handleError))}getWeaponDetails(t,r){if(!t||!r)return(0,u.$)(()=>new Error("Categoria e nome da arma s\xe3o obrigat\xf3rios"));const e=(new n.Nl).set("action","weapon").set("category",t).set("name",r),s=`${this.baseUrl}?${e.toString()}`;return this.http.get(s).pipe((0,i.T)(a=>{if(a.success)return a;throw new Error(a.message||"Erro ao buscar detalhes da arma")}),(0,l.W)(this.handleError))}searchWeapons(t,r){const e=(new n.Nl).set("action","list").set("category",t).set("search",r);return this.http.get(`${this.baseUrl}?${e.toString()}`).pipe((0,i.T)(s=>{if(s.success)return s;throw new Error(s.message||"Erro ao buscar armas")}),(0,l.W)(this.handleError))}getCategoryStats(t){return this.getWeaponsByCategory(t).pipe((0,i.T)(r=>{const e=r.data,s=e.length,a={},d={};let E=0,f=0;return e.forEach(c=>{a[c.vocation]=(a[c.vocation]||0)+1,d[c.tier]=(d[c.tier]||0)+1,E+=c.atk,f+=c.def}),{total:s,byVocation:a,byTier:d,avgAtk:s>0?E/s:0,avgDef:s>0?f/s:0}}))}hasElementalDamage(t){return t.proficiency?.levels?.some(r=>r.perks?.some(e=>e.description.toLowerCase().includes("fire")||e.description.toLowerCase().includes("ice")||e.description.toLowerCase().includes("energy")||e.description.toLowerCase().includes("earth")||e.description.toLowerCase().includes("death")||e.description.toLowerCase().includes("holy")))||!1}getPrimaryElementalType(t){if(!t.proficiency?.levels)return null;const r=["fire","ice","energy","earth","death","holy"];for(const e of t.proficiency.levels)for(const s of e.perks||[])for(const a of r)if(s.description.toLowerCase().includes(a))return a;return null}getCategoryDisplayName(t){return{swords:"Espadas",axes:"Machados",clavas:"Clavas",ranged:"Armas de Longo Alcance",rods:"Rods",wands:"Wands",fist:"Armas de Punho"}[t]||t}getIconAssetPath(t){return t.startsWith("assets/")||t.startsWith("http")?t:t.startsWith("icons/")?`assets/${t}`:"assets/icons/32_11345f84.png"}handleError(t){console.error("Erro na requisi\xe7\xe3o HTTP:",t);let r="Erro desconhecido";return r=t.error instanceof ErrorEvent?`Erro: ${t.error.message}`:t.error?.message||t.message||`C\xf3digo de erro: ${t.status}`,(0,u.$)(()=>new Error(r))}static{this.\u0275fac=function(r){return new(r||h)(g.KVO(n.Qq))}}static{this.\u0275prov=g.jDH({token:h,factory:h.\u0275fac,providedIn:"root"})}}return h})()}}]);