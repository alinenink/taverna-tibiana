"use strict";(self.webpackChunktaverna_tibiana=self.webpackChunktaverna_tibiana||[]).push([[76],{4231:(y,_,a)=>{a.d(_,{T:()=>v});var n=a(1626),E=a(8810),l=a(6354),h=a(9437),g=a(5875),u=a(4020);let v=(()=>{class s{constructor(t){this.http=t,this.baseUrl=g.c.apiUrl+"/weapons"}getCategories(){const t=(new n.Nl).set("action","categories");return this.http.get(`${this.baseUrl}?${t.toString()}`).pipe((0,l.T)(r=>{if(r.success&&r.data)return r.data;throw new Error(r.message||"Erro ao buscar categorias")}),(0,h.W)(this.handleError))}getAllWeapons(){const t=(new n.Nl).set("action","all");return this.http.get(`${this.baseUrl}?${t.toString()}`).pipe((0,l.T)(r=>{if(r.success&&r.data)return r.data;throw new Error(r.message||"Erro ao buscar todas as armas")}),(0,h.W)(this.handleError))}getWeaponsByCategory(t){const r=(new n.Nl).set("action","list").set("category",t);return this.http.get(`${this.baseUrl}?${r.toString()}`).pipe((0,l.T)(e=>{if(e.success)return e;throw new Error(e.message||"Erro ao buscar armas da categoria")}),(0,h.W)(this.handleError))}getWeaponDetails(t,r){if(!t||!r)return(0,E.$)(()=>new Error("Categoria e nome da arma s\xe3o obrigat\xf3rios"));const e=(new n.Nl).set("action","weapon").set("category",t).set("name",r),o=`${this.baseUrl}?${e.toString()}`;return this.http.get(o).pipe((0,l.T)(c=>{if(c.success)return c;throw new Error(c.message||"Erro ao buscar detalhes da arma")}),(0,h.W)(this.handleError))}searchWeapons(t,r){const e=(new n.Nl).set("action","list").set("category",t).set("search",r);return this.http.get(`${this.baseUrl}?${e.toString()}`).pipe((0,l.T)(o=>{if(o.success)return o;throw new Error(o.message||"Erro ao buscar armas")}),(0,h.W)(this.handleError))}getCategoryStats(t){return this.getWeaponsByCategory(t).pipe((0,l.T)(r=>{const e=r.data,o=e.length,c={},p={};let f=0,m=0;return e.forEach(d=>{c[d.vocation]=(c[d.vocation]||0)+1,p[d.tier]=(p[d.tier]||0)+1,f+=d.atk,m+=d.def}),{total:o,byVocation:c,byTier:p,avgAtk:o>0?f/o:0,avgDef:o>0?m/o:0}}))}hasElementalDamage(t){return t.proficiency?.levels?.some(r=>r.perks?.some(e=>e.description.toLowerCase().includes("fire")||e.description.toLowerCase().includes("ice")||e.description.toLowerCase().includes("energy")||e.description.toLowerCase().includes("earth")||e.description.toLowerCase().includes("death")||e.description.toLowerCase().includes("holy")))||!1}getPrimaryElementalType(t){if(!t.proficiency?.levels)return null;const r=["fire","ice","energy","earth","death","holy"];for(const e of t.proficiency.levels)for(const o of e.perks||[])for(const c of r)if(o.description.toLowerCase().includes(c))return c;return null}getCategoryDisplayName(t){return{swords:"Espadas",axes:"Machados",clavas:"Clavas",ranged:"Armas de Longo Alcance",rods:"Rods",wands:"Wands",fist:"Armas de Punho"}[t]||t}getIconAssetPath(t){return t.startsWith("assets/")||t.startsWith("http")?t:t.startsWith("icons/")?`assets/${t}`:"assets/icons/32_11345f84.png"}handleError(t){console.error("Erro na requisi\xe7\xe3o HTTP:",t);let r="Erro desconhecido";return r=t.error instanceof ErrorEvent?`Erro: ${t.error.message}`:t.error?.message||t.message||`C\xf3digo de erro: ${t.status}`,(0,E.$)(()=>new Error(r))}static{this.\u0275fac=function(r){return new(r||s)(u.KVO(n.Qq))}}static{this.\u0275prov=u.jDH({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})()},6706:(y,_,a)=>{a.d(_,{T:()=>g});var n=a(467),E=a(5875),l=a(4796),h=a(4020);let g=(()=>{class u{constructor(s){this.authService=s,this.baseURL=E.c.apiUrl}getHeaders(){return{"Content-Type":"application/json",Authorization:`Bearer ${this.authService.getToken()}`}}save(s){var i=this;return(0,n.A)(function*(){try{const t=yield fetch(`${i.baseURL}/weapons?action=save-perks`,{method:"POST",headers:i.getHeaders(),body:JSON.stringify(s)});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return yield t.json()}catch(t){throw console.error("Erro ao salvar profici\xeancia:",t),t}})()}get(s,i){var t=this;return(0,n.A)(function*(){try{const r=`${t.baseURL}/weapons?action=get-perks&weapon_name=${encodeURIComponent(s)}&weapon_category=${i}`,e=yield fetch(r,{headers:t.getHeaders()});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return yield e.json()}catch(r){throw console.error("Erro ao buscar profici\xeancia:",r),r}})()}list(s="",i=1,t=10){var r=this;return(0,n.A)(function*(){try{const e=`action=list-perks&page=${i}&limit=${t}${s?`&weapon_category=${s}`:""}`,o=yield fetch(`${r.baseURL}/weapons?${e}`,{headers:r.getHeaders()});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return yield o.json()}catch(e){throw console.error("Erro ao listar profici\xeancias:",e),e}})()}delete(s,i){var t=this;return(0,n.A)(function*(){try{const r=`${t.baseURL}/weapons?action=delete-perks&weapon_name=${encodeURIComponent(s)}&weapon_category=${i}`,e=yield fetch(r,{method:"DELETE",headers:{Authorization:`Bearer ${t.authService.getToken()}`}});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return yield e.json()}catch(r){throw console.error("Erro ao deletar profici\xeancia:",r),r}})()}static{this.\u0275fac=function(i){return new(i||u)(h.KVO(l.u))}}static{this.\u0275prov=h.jDH({token:u,factory:u.\u0275fac,providedIn:"root"})}}return u})()}}]);